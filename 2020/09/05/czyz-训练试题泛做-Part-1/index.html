<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fsy-juruo.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="本系列不定期更新，每个 Part 约有 $6 \sim 8$ 题，一般一个专题一个 Part，具体题目数量视标签个数而定。">
<meta property="og:type" content="article">
<meta property="og:title" content="常州一中训练试题泛做 Part 1">
<meta property="og:url" content="http://fsy-juruo.github.io/2020/09/05/czyz-%E8%AE%AD%E7%BB%83%E8%AF%95%E9%A2%98%E6%B3%9B%E5%81%9A-Part-1/index.html">
<meta property="og:site_name" content="fsy&#39;s blog">
<meta property="og:description" content="本系列不定期更新，每个 Part 约有 $6 \sim 8$ 题，一般一个专题一个 Part，具体题目数量视标签个数而定。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-09-05T12:00:43.000Z">
<meta property="article:modified_time" content="2020-09-19T03:32:59.984Z">
<meta property="article:author" content="fsy">
<meta property="article:tag" content="【类别】比赛题解">
<meta property="article:tag" content="【算法】分块">
<meta property="article:tag" content="【算法】构造及其证明">
<meta property="article:tag" content="【算法】Miller-Rabin 素性检验">
<meta property="article:tag" content="【题型】好题">
<meta property="article:tag" content="【算法】二项式定理">
<meta property="article:tag" content="【算法】概率与期望">
<meta property="article:tag" content="【算法】矩阵乘法">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://fsy-juruo.github.io/2020/09/05/czyz-%E8%AE%AD%E7%BB%83%E8%AF%95%E9%A2%98%E6%B3%9B%E5%81%9A-Part-1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>常州一中训练试题泛做 Part 1 | fsy's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">fsy's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">燃峥嵘岁月，烈日终破云。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://fsy-juruo.github.io/2020/09/05/czyz-%E8%AE%AD%E7%BB%83%E8%AF%95%E9%A2%98%E6%B3%9B%E5%81%9A-Part-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar01.png">
      <meta itemprop="name" content="fsy">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fsy's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          常州一中训练试题泛做 Part 1
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-05 20:00:43" itemprop="dateCreated datePublished" datetime="2020-09-05T20:00:43+08:00">2020-09-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-19 11:32:59" itemprop="dateModified" datetime="2020-09-19T11:32:59+08:00">2020-09-19</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>本系列不定期更新，每个 Part 约有 $6 \sim 8$ 题，一般一个专题一个 Part，具体题目数量视标签个数而定。</p>
<a id="more"></a>

<p><strong>8/5 T1</strong>  絶対、大丈夫！</p>
<p>设原数为 $\overline{a_1a_2a_3 \cdots a_n}$，明显，$P = \sum_{i=1}^{n} a_i \times (10^i-10^{p_i})$，其中 ${p_1, p_2, \cdots, p_n}$ 是 $1 \sim n$ 的一个排列。</p>
<p>经过简单推导易证对于任意 $x, y \in \mathbb{N}$，$(10^x-10^y) \bmod 9 = 0$，故 $P \bmod 9 = 0$。</p>
<p>能被 $9$ 整除的数各位数加起来一定为 $9$ 的倍数。又因为删去的一位数不为 $0$，所以删去的那一位数是唯一的。答案即为 $9 - P \text{的数位和} \bmod 9$。</p>
<p>再考虑构造解。由于 $P \bmod 9 = 0$，于是设 $T = \frac{P}{9}$（带前导零），$S=10T$，容易证明 $S-T=P$ 且组成 $S$，$T$ 的数字相同。由于允许前导零，直接输出 $S$，$T$ 即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _rep(i, x, y) for(int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _per(i, x, y) for(int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">    x = <span class="number">0</span>; T f = (T) <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(c); c = getchar())</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;-&#x27;</span>) f = -f;</span><br><span class="line">    <span class="keyword">for</span> (; <span class="built_in">isdigit</span>(c); c = getchar()) x = x * <span class="number">10</span> + c - <span class="number">48</span>;</span><br><span class="line">    x *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>) &#123;<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); x = -x;&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">9</span>) write(x / <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writesp</span><span class="params">(T x, <span class="keyword">char</span> sp = <span class="string">&#x27;\n&#x27;</span>)</span> </span>&#123;</span><br><span class="line">	write(x); <span class="built_in">putchar</span>(sp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxN = <span class="number">5e5</span> + <span class="number">10</span>, maxM = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> P;</span><br><span class="line"><span class="keyword">int</span> n, len;</span><br><span class="line"><span class="keyword">int</span> Delta[maxN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> q = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">	_rep(i, <span class="number">1</span>, len + <span class="number">1</span>) &#123;</span><br><span class="line">		r = r * <span class="number">10</span> + Delta[i];</span><br><span class="line">		Delta[i] = r / <span class="number">9</span>;</span><br><span class="line">		r %= <span class="number">9</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">&quot;yukikaze.in&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">&quot;yukikaze.out&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; P; <span class="keyword">int</span> cnt = <span class="number">0</span>; len = P.size();</span><br><span class="line">	_rep(i, <span class="number">0</span>, len - <span class="number">1</span>) &#123;cnt = (cnt + P[i] - <span class="string">&#x27;0&#x27;</span>) % <span class="number">9</span>;&#125;</span><br><span class="line">	_rep(i, <span class="number">0</span>, len - <span class="number">1</span>) &#123;Delta[i + <span class="number">2</span>] = P[i] - <span class="string">&#x27;0&#x27;</span>;&#125;</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="number">9</span> - cnt + <span class="string">&#x27;0&#x27;</span>); <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>; Delta[<span class="number">1</span>] = <span class="number">9</span> - cnt;</span><br><span class="line">	divide();</span><br><span class="line">	<span class="keyword">int</span> st = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(!Delta[st]) st++;</span><br><span class="line">	_rep(i, st, len + <span class="number">1</span>) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; Delta[i];</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;0\n0&quot;</span>;</span><br><span class="line">	_rep(i, st, len + <span class="number">1</span>) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; Delta[i];</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>8/6 T2</strong>  まるゆ，潜航 ！</p>
<p>设 $1 \sim n-1$ 号まるゆ运输的货物的类型的<strong>并集</strong> $U$ 大小为 $u$，<strong>交集</strong> $V$ 大小为 $v$，明显有 $0 \leq v \leq u \leq k-1$。</p>
<p>答案即为：</p>
<p>$$<br>\sum_{u=0}^{k-1} \sum_{v=0}^{u} \binom{k}{u} \binom{u}{v} \left( 2^{n-1}-2 \right)^{u-v} 2^{k-v} (2^k-2^u)<br>$$</p>
<p>对每个部分单独解释：</p>
<ul>
<li>$\binom{k}{u}$、$\binom{u}{v}$：从 $k$ 个货物里选 $u$ 个作为并集，从 $u$ 个货物里选 $v$ 个作为交集。</li>
<li>$(2^{n-1}-2)^{u-v}$：分成三种情况考虑。<ul>
<li>1、对于交集内的物品：$1 \sim n-1$ 号まるゆ必须全部选这个物品。</li>
<li>2、对于不在并集内的物品：$1 \sim n-1$ 号まるゆ必须都不选这个物品。</li>
<li>3、对于在并集，不在交集内的物品：$1 \sim n-1$ 号まるゆ不能都选或都不选这个货物，剩下方案随意，故此部分贡献为 $(2^{n-1}-2)^{u-v}$。</li>
</ul>
</li>
<li>$2^{k-v}$：对于 $0$ 号まるゆ，他不能选 $V$ 内的物品，否则就不满足限制 1。剩余货物随意，故此部分贡献为 $2^{k-v}$。</li>
<li>$2^k-2^u$：对于 $n$ 号まるゆ，他不能同时选择不在 $U$ 内的物品，否则就不满足限制 2。剩下货物随意，故此部分贡献为 $(2^{k-u}-1) \times 2^u = 2^k - 2^u$。</li>
</ul>
<p>接下来就是化简，疯狂二项式定理，一顿操作猛如虎：</p>
<p>$$<br>\begin{align}<br>Ans = &amp; \sum_{u=0}^{k-1} \sum_{v=0}^{u} \binom{k}{u} \binom{u}{v} (2^{n-1}-2)^{u-v} 2^{k-v}(2^k-2^u)\\<br>= &amp; \sum_{u=0}^{k-1} \binom{k}{u}(2^k-2^u)2^k \sum_{v=0}^{u} \binom{u}{v} (2^{n-1}-2)^{u-v} \left(2^{-1}\right)^v\\<br>= &amp; \sum_{u=0}^{k-1} \binom{k}{u}(2^k-2^u)2^k(2^{n-1}-2+2^{-1})^u\\<br>= &amp; 4^k \times \sum_{u=0}^{k-1} \binom{k}{u} (2^{n-1}-2+2^{-1})^u 1^{k-u}-2^k \times \sum_{u=0}^{k-1} \binom{k}{u} (2^n-3)^u 1^{k-u}\\<br>= &amp; 4^k \times [(2^{n-1}-1+2^{-1})^k-(2^{n-1}-2+2^{-1})^k] - 2^k [(2^{n}-2)^k-(2^{n}-3)^k]\\<br>= &amp; (2^{n+1}-2)^k-(2^{n+1}-6)^k-(2^{n+1}-4)^k+(2^{n+1}-6)^k\\<br>= &amp; (2^{n+1}-2)^k-(2^{n+1}-4)^k\\<br>\end{align}<br>$$</p>
<p>快速幂计算即可。</p>
<p>时间复杂度：$\mathcal{O}(T \log^2 k)$。</p>
<p><strong>代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _rep(i, x, y) for(int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _per(i, x, y) for(int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">	x = <span class="number">0</span>; T f = (T) <span class="number">1</span>; <span class="keyword">char</span> c = getchar();</span><br><span class="line">	<span class="keyword">for</span>(; !<span class="built_in">isdigit</span>(c); c = getchar()) &#123;<span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) f = -f;&#125;</span><br><span class="line">	<span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar()) x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	x *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>) &#123;x = -x; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">9</span>) write(x / <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writesp</span><span class="params">(T x, <span class="keyword">char</span> sp = <span class="string">&#x27; &#x27;</span>)</span> </span>&#123;</span><br><span class="line">	write(x); <span class="built_in">putchar</span>(sp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span> + <span class="number">7</span>, maxN = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line">LL n, k;</span><br><span class="line"><span class="keyword">int</span> fac[maxN], facinv[maxN], powtwo[maxN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pow_mod</span><span class="params">(<span class="keyword">int</span> a, LL b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sum = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b) &#123;</span><br><span class="line">		<span class="keyword">if</span>(b &amp; <span class="number">1ll</span>) sum = <span class="number">1ll</span> * sum * a % p;</span><br><span class="line">		a = <span class="number">1ll</span> * a * a % p;</span><br><span class="line">		b &gt;&gt;= <span class="number">1ll</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;maruyu.in&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;maruyu.out&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">	read(T);</span><br><span class="line">	<span class="keyword">while</span>(T--) &#123;</span><br><span class="line">		read(n); read(k);</span><br><span class="line">		<span class="keyword">int</span> Q = pow_mod(<span class="number">2</span>, n + <span class="number">1</span>, P);</span><br><span class="line">		<span class="keyword">int</span> ans = (pow_mod((Q - <span class="number">2</span> + P) % P, k, P) - pow_mod((Q - <span class="number">4</span> + P) % P, k, P) + P) % P;</span><br><span class="line">		writesp(ans, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>9/14 T2</strong> 大凤号装甲空母</p>
<p>先给出一种比较友好的思考方法。</p>
<p>设 $x = \frac{\sqrt{5}+1}{2}$，使用计算器计算 $x^n$，可以发现几个性质：</p>
<ul>
<li>$x^n + x^{n+1} = x^{n+2}$</li>
<li>$|x^n - \operatorname{round}(x^n)|$ 逐渐变小，其中 $\operatorname{round}(a)$ 表示四舍五入。</li>
</ul>
<p>设 $f(x) = \lfloor x^n \rfloor$，$\epsilon(x) = [x \bmod 2 = 1]$，再经过仔细观察后不难得到：$f(x) = f(x - 1) + f(x - 2) + \epsilon(x)$。</p>
<p>如果舍去 $\epsilon(x)$ 一项，则该式是经典的 Fibonacci 数列，可以用矩阵乘法求出。但其实 $\epsilon(x)$ 函数有性质 $\epsilon(x) = \epsilon(x - 2)$，于是乎：<br>$$<br>\begin{bmatrix}<br>f(n-1) &amp; f(n) &amp; \epsilon(x-1) &amp; \epsilon(x)<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>f(n-2) &amp; f(n-1) &amp; \epsilon(x-2) &amp; \epsilon(x-1)<br>\end{bmatrix}<br>\begin{bmatrix}<br>0 &amp; 1 &amp; 0 &amp; 0 \\<br>1 &amp; 1 &amp; 0 &amp; 0 \\<br>0 &amp; 1 &amp; 0 &amp; 1 \\<br>0 &amp; 0 &amp; 1 &amp; 0 \\<br>\end{bmatrix}<br>$$<br>矩阵快速幂即可，时间复杂度 $\mathcal{O}(4^3 \times \log n)$。</p>
<p><strong>代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> reg register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _rep(i, x, y) for(int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _per(i, x, y) for(int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">	x = <span class="number">0</span>; T f = (T) <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> c = getchar();</span><br><span class="line">	<span class="keyword">for</span>(; !<span class="built_in">isdigit</span>(c); c = getchar()) &#123;<span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) f = -f;&#125;</span><br><span class="line">	<span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar()) x = x * <span class="number">10</span> + c - <span class="number">48</span>;</span><br><span class="line">	x *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>) &#123;x = -x; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">9</span>) write(x / <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writesp</span><span class="params">(T x, <span class="keyword">char</span> sp = <span class="string">&#x27; &#x27;</span>)</span> </span>&#123;write(x); <span class="built_in">putchar</span>(sp);&#125;</span><br><span class="line">LL n;</span><br><span class="line"><span class="keyword">int</span> p;</span><br><span class="line"><span class="keyword">int</span> Pows[<span class="number">100</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">29</span>, <span class="number">46</span>, <span class="number">76</span>, <span class="number">122</span>, <span class="number">199</span>, <span class="number">321</span>, <span class="number">521</span>, <span class="number">842</span>, <span class="number">1364</span>, <span class="number">2206</span>, <span class="number">3571</span>, <span class="number">5777</span>, <span class="number">9349</span>, <span class="number">15126</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> F[<span class="number">7</span>], a[<span class="number">7</span>][<span class="number">7</span>], f[<span class="number">7</span>], c[<span class="number">7</span>][<span class="number">7</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fib</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">	_rep(j, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">		_rep(k, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">			f[j] = (f[j] + <span class="number">1ll</span> * F[k] * a[k][j] % p) % p;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">0</span>, <span class="number">3</span>) F[i] = f[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">square</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</span><br><span class="line">	_rep(i, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">		_rep(j, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">			_rep(k, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">				c[i][j] = (c[i][j] + <span class="number">1ll</span> * a[i][k] * a[k][j] % p) % p;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">		_rep(j, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">			a[i][j] = c[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;taiho.in&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;taiho.out&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">	read(n); read(p);</span><br><span class="line">	<span class="keyword">if</span>(p == <span class="number">1</span>) &#123;</span><br><span class="line">		writesp(<span class="number">0</span>, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(n &lt;= <span class="number">1e6</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n &lt;= <span class="number">20</span>) &#123;</span><br><span class="line">			writesp(Pows[n] % p, <span class="string">&#x27;\n&#x27;</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> l1 = <span class="number">1</span>, l2 = <span class="number">2</span>, l3 = <span class="number">4</span>;</span><br><span class="line">		_rep(i, <span class="number">4</span>, n) &#123;</span><br><span class="line">			l1 = l2; l2 = l3;</span><br><span class="line">			l3 = (l1 + l2 + (i % <span class="number">2</span> == <span class="number">1</span>)) % p; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, l3);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		F[<span class="number">0</span>] = <span class="number">1</span>; F[<span class="number">1</span>] = <span class="number">1</span>; F[<span class="number">2</span>] = <span class="number">1</span>; F[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">		a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>; a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>; a[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>; a[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		a[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>; a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>; a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>; a[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		a[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>; a[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>; a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>; a[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">		a[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>; a[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>; a[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">1</span>; a[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(n) &#123;</span><br><span class="line">			<span class="keyword">if</span>(n &amp; <span class="number">1</span>) Fib();</span><br><span class="line">			square(); n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		writesp(F[<span class="number">0</span>], <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>std 的特征根法得咕一会…</p>
<p><strong>8/7 T3</strong> 最大割</p>
<p>Hexo nmd 竟然不支持 <code>\bold&#123;&#125;</code>…</p>
<p>首先，期望就等于边权 $\times$ 两个点不在同一集合的概率。</p>
<p>列出式子可得：<br>$$<br>\begin{align}<br>E(maxcut) = &amp; \sum_{(i,j) \in E} a_{i,j} \times \left[\left(\frac{1}{2} \times (1 + \varphi_s(\langle \mathbf{u_j, Z} \rangle))\right) \times \left(\frac{1}{2} \times (1 - \varphi_s(\langle \mathbf{u_i, Z} \rangle))\right) + \left(\frac{1}{2} \times (1 + \varphi_s(\langle \mathbf{u_i, Z} \rangle))\right) \times \left(\frac{1}{2} \times (1 - \varphi_s(\langle \mathbf{u_j, Z} \rangle))\right)\right] \\<br>= &amp; \sum_{(i,j) \in E} a_{i,j} \times \left[\frac{1}{2} \times (1-\varphi_s(\langle \mathbf{u_i, Z} \rangle)\varphi_s(\langle \mathbf{u_j, Z} \rangle)) \right]<br>\end{align}<br>$$<br>设 $r_i = \langle \mathbf{u_i, Z} \rangle$，将 $r_i$ 按绝对值升序排序。</p>
<p>注意到 $E(maxcut)$ 是一个关于 $\frac{1}{s}$ 的二次函数，且在 $[r_i, r_{i+1}]$ 中连续均匀。考虑暴力计算系数，分段求最值，单次时间复杂度 $\mathcal{O}(n^3)$，不够优秀。</p>
<p>再注意到在 $[r_i, r_{i+1}]$ 转移至 $[r_{i+1}, r_{i+2}]$ 时，只会有一个点的 $\varphi_s$ 值发生变化，于是只计算这一个点的影响，就能将单次时间复杂度降为 $\mathcal{O}(n^2)$。</p>
<p><strong>代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _rep(i, x, y) for(int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _per(i, x, y) for(int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">    x = <span class="number">0</span>; T f = (T) <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> c = getchar();</span><br><span class="line">    <span class="keyword">for</span> (; !<span class="built_in">isdigit</span>(c); c = getchar())</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;-&#x27;</span>) f = -f;</span><br><span class="line">    <span class="keyword">for</span> (; <span class="built_in">isdigit</span>(c); c = getchar()) x = x * <span class="number">10</span> + c - <span class="number">48</span>;</span><br><span class="line">    x *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>) &#123;<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); x = -x;&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">9</span>) write(x / <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writesp</span><span class="params">(T x, <span class="keyword">char</span> sp = <span class="string">&#x27; &#x27;</span>)</span> </span>&#123;</span><br><span class="line">	write(x); <span class="built_in">putchar</span>(sp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxN = <span class="number">151</span>, maxQ = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> INF = <span class="number">1e14</span>;</span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">double</span> a[maxN][maxN], u[maxN][maxN], Z[maxN];</span><br><span class="line"><span class="keyword">double</span> A, B, C, product[maxN], ccf;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">	<span class="keyword">double</span> pro;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">&#125; r[maxN];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node A, node B)</span> </span>&#123;<span class="keyword">return</span> <span class="built_in">fabs</span>(A.pro) &lt; <span class="built_in">fabs</span>(B.pro);&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sgn</span><span class="params">(<span class="keyword">double</span> S)</span> </span>&#123;<span class="keyword">return</span> S &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;maxcut.in&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;maxcut.out&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">	read(n); read(q);</span><br><span class="line">	_rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a[i][j]), ccf += a[i][j] * (i &lt; j);</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;u[i][j]);	</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">1</span>, q) &#123;</span><br><span class="line">		A = <span class="number">0</span>, B = <span class="number">0</span>, C = <span class="number">0</span>; </span><br><span class="line">		_rep(j, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;Z[j]);</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			r[j].id = j; product[j] = <span class="number">0</span>;</span><br><span class="line">			_rep(k, <span class="number">1</span>, n) &#123;product[j] += u[j][k] * Z[k];&#125;</span><br><span class="line">			r[j].pro = product[j];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(r + <span class="number">1</span>, r + n + <span class="number">1</span>, cmp); r[n + <span class="number">1</span>].pro = INF;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			_rep(k, <span class="number">1</span>, j - <span class="number">1</span>) C += sgn(product[j]) * sgn(product[k]) * a[j][k];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">double</span> ans = C;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			<span class="keyword">double</span> qwq = <span class="built_in">fabs</span>(r[j].pro), qaq = <span class="built_in">fabs</span>(r[j + <span class="number">1</span>].pro);</span><br><span class="line">			<span class="keyword">int</span> f = r[j].id;</span><br><span class="line">			_rep(k, <span class="number">1</span>, n) &#123;</span><br><span class="line">				<span class="keyword">if</span>(k == f) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">fabs</span>(product[k]) &lt; qwq) &#123; </span><br><span class="line">					B -= product[k] * sgn(product[f]) * a[f][k];</span><br><span class="line">					A += product[k] * product[f] * a[f][k];</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">					C -= sgn(product[k]) * sgn(product[f]) * a[f][k];</span><br><span class="line">					B += sgn(product[k]) * product[f] * a[f][k];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(qwq == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="built_in">std</span>::swap(qwq, qaq); </span><br><span class="line">			qwq = <span class="number">1.0</span> / qwq; qaq = <span class="number">1.0</span> / qaq; </span><br><span class="line">			<span class="keyword">double</span> m = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(A == <span class="number">0</span>) &#123; </span><br><span class="line">				m = (B &lt; <span class="number">0</span> ? qaq : qwq);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">				<span class="keyword">double</span> axis = -B * <span class="number">1.0</span> / (<span class="number">2</span> * A);</span><br><span class="line">				<span class="keyword">if</span>(axis &gt;= qaq) m = (A &lt; <span class="number">0</span> ? qwq : qaq);</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(axis &lt;= qwq) m = (A &lt; <span class="number">0</span> ? qaq : qwq);</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					m = (A &gt; <span class="number">0</span> ? axis : (qaq - axis &gt; axis - qwq ? qaq : qwq));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">double</span> fuk = (LD)(A * m * m + B * m + C);</span><br><span class="line">			ans = <span class="built_in">std</span>::min(ans, fuk);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%.10f\n&quot;</span>, <span class="number">0.5</span> * (ccf - ans));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>8/12 T3</strong> Math</p>
<p><del>提高组出 Miller-Rabin，出题人真厉害</del></p>
<p>考虑 Miller-Rabin + Pollard-rho，但是如果出题人恶意构造数据的话 Pollard-rho 会退化为 $\mathcal{O}(\sqrt{n})$。</p>
<p>所以考虑以下思路：先将 $a_i$ 所有 $10^6$ 以内的因子筛除，那么筛除过后，$a_i$ 的值就只会有三种情况：（1）质数，（2）质数的完全平方，（3）两个不同质数的积</p>
<p>但是直接计数的话会重复计算在所有 $a_i$ 中出现多次的质数，所以我们还需要先筛除所有出现多次的质数。具体实现很简单，因为现在 $a_i$ 最多由两个质数相乘而得，所以两两之间求 $\gcd$ 就相当于计算哪些质数出现了多次。</p>
<p>再筛去这些质数后，就可以直接计数求贡献了。</p>
<p>时间复杂度 $\mathcal{O}(10^6 + cn \log^3 SIZ + n^2 \log SIZ)$，其中 $c$ 为 Miller-Rabin 的测试次数，$SIZ$ 为值域 $10^{18}$。</p>
<p><strong>注意：两两求 $\gcd$ 时求出的 $\gcd$ 可能不是质数，一定要注意这一情况！</strong></p>
<p><strong>代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LD long double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _rep(i, x, y) for(int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _per(i, x, y) for(int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;x)</span> </span>&#123;</span><br><span class="line">	x = <span class="number">0</span>;  T f = (T) <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> c = getchar();</span><br><span class="line">	<span class="keyword">for</span>(; !<span class="built_in">isdigit</span>(c); c = getchar()) &#123;<span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) f = -f;&#125;</span><br><span class="line">	<span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar()) x = x * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">	x *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x &lt; <span class="number">0</span>) &#123;x = -x; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);&#125;</span><br><span class="line">	<span class="keyword">if</span>(x &gt; <span class="number">9</span>) write(x / <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">writesp</span><span class="params">(T x, <span class="keyword">char</span> sp = <span class="string">&#x27; &#x27;</span>)</span> </span>&#123;</span><br><span class="line">	write(x); <span class="built_in">putchar</span>(sp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxN = <span class="number">1e6</span> + <span class="number">10</span>, BLK = <span class="number">1e6</span>, P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> vis[maxN], primes[maxN], siz = <span class="number">0</span>, zzjakioi = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">LL a[<span class="number">510</span>], qaq[<span class="number">250001</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">	_rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!vis[i]) &#123;primes[++siz] = i; vis[i] = i;&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= siz; j++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(primes[j] &gt; vis[i] || primes[j] &gt; n/i) <span class="keyword">break</span>;</span><br><span class="line">			vis[i * primes[j]] = primes[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> tests[<span class="number">13</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>&#125;;</span><br><span class="line"><span class="function">LL <span class="title">mul_mod</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">	a %= p; b %= p;</span><br><span class="line">	LL c = (LD) a * b / p;</span><br><span class="line">	LL ans = a * b - c * p;</span><br><span class="line">	<span class="keyword">if</span>(ans &lt; <span class="number">0</span>) ans += p;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(ans &gt;= p) ans -= p;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">pow_mod</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">	LL ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b) &#123;</span><br><span class="line">		<span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = mul_mod(ans, a, p);</span><br><span class="line">		a = mul_mod(a, a, p);</span><br><span class="line">		b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">miller_rabin</span><span class="params">(LL x)</span> </span>&#123;</span><br><span class="line">	LL rem = x - <span class="number">1</span>; <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(!(rem &amp; <span class="number">1</span>)) &#123;rem &gt;&gt;= <span class="number">1</span>; cnt++;&#125;</span><br><span class="line">	_rep(i, <span class="number">0</span>, <span class="number">11</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(x == tests[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span>(x % tests[i] == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		LL qwq = pow_mod(tests[i], rem, x);</span><br><span class="line">		LL y = qwq;</span><br><span class="line">		_rep(i, <span class="number">1</span>, cnt) &#123;</span><br><span class="line">			qwq = mul_mod(qwq, qwq, x);</span><br><span class="line">			<span class="keyword">if</span>(qwq == <span class="number">1</span> &amp;&amp; y != <span class="number">1</span> &amp;&amp; y != x - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			y = qwq;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(qwq != <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a, LL b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!a || !b) <span class="keyword">return</span> a + b;</span><br><span class="line">	<span class="keyword">return</span> gcd(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	freopen(<span class="string">&quot;math.in&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">&quot;math.out&quot;</span>, <span class="string">&quot;w&quot;</span>, <span class="built_in">stdout</span>);</span><br><span class="line">	read(n);</span><br><span class="line">	_rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">		read(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	sieve(BLK);</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">	_rep(i, <span class="number">1</span>, siz) &#123;</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			<span class="keyword">while</span>(a[j] % primes[i] == <span class="number">0</span>) &#123;</span><br><span class="line">				cnt++; a[j] /= primes[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans = <span class="number">1ll</span> * ans * (cnt + <span class="number">1</span>) % P;</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			<span class="keyword">if</span>(i == j) <span class="keyword">continue</span>;</span><br><span class="line">			LL k = gcd(a[i], a[j]);</span><br><span class="line">			<span class="keyword">if</span>(k != <span class="number">1</span>) qaq[++zzjakioi] = k;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::sort(qaq + <span class="number">1</span>, qaq + zzjakioi + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> len = <span class="built_in">std</span>::unique(qaq + <span class="number">1</span>, qaq + zzjakioi + <span class="number">1</span>) - qaq - <span class="number">1</span>;</span><br><span class="line">	_rep(i, <span class="number">1</span>, len) &#123;</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		_rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">			<span class="keyword">while</span>(!(a[j] % qaq[i])) &#123;</span><br><span class="line">				a[j] /= qaq[i]; cnt++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(miller_rabin(qaq[i])) ans = <span class="number">1ll</span> * ans * (cnt + <span class="number">1</span>) % P;</span><br><span class="line">		<span class="keyword">else</span> ans = <span class="number">1ll</span> * ans * (cnt + <span class="number">1</span>) % P * (cnt + <span class="number">1</span>) % P;</span><br><span class="line">	&#125;</span><br><span class="line">	_rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] != <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(miller_rabin(a[i])) &#123;</span><br><span class="line">				ans = <span class="number">2ll</span> * ans % P;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">int</span> k = (<span class="keyword">int</span>)(<span class="built_in">sqrt</span>(a[i]));</span><br><span class="line">				<span class="keyword">if</span>(<span class="number">1ll</span> * k * k == a[i]) &#123;</span><br><span class="line">					ans = <span class="number">3ll</span> * ans % P;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					ans = <span class="number">4ll</span> * ans % P;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	writesp(ans, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>fsy
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://fsy-juruo.github.io/2020/09/05/czyz-%E8%AE%AD%E7%BB%83%E8%AF%95%E9%A2%98%E6%B3%9B%E5%81%9A-Part-1/" title="常州一中训练试题泛做 Part 1">http://fsy-juruo.github.io/2020/09/05/czyz-训练试题泛做-Part-1/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E3%80%90%E7%B1%BB%E5%88%AB%E3%80%91%E6%AF%94%E8%B5%9B%E9%A2%98%E8%A7%A3/" rel="tag"># 【类别】比赛题解</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E5%88%86%E5%9D%97/" rel="tag"># 【算法】分块</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%9E%84%E9%80%A0%E5%8F%8A%E5%85%B6%E8%AF%81%E6%98%8E/" rel="tag"># 【算法】构造及其证明</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91Miller-Rabin-%E7%B4%A0%E6%80%A7%E6%A3%80%E9%AA%8C/" rel="tag"># 【算法】Miller-Rabin 素性检验</a>
              <a href="/tags/%E3%80%90%E9%A2%98%E5%9E%8B%E3%80%91%E5%A5%BD%E9%A2%98/" rel="tag"># 【题型】好题</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86/" rel="tag"># 【算法】二项式定理</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/" rel="tag"># 【算法】概率与期望</a>
              <a href="/tags/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95/" rel="tag"># 【算法】矩阵乘法</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/26/Educational-Codeforces-Round-94-Rated-for-Div-2-%E9%A2%98%E8%A7%A3/" rel="prev" title="Educational Codeforces Round 94 (Rated for Div. 2) 题解">
      <i class="fa fa-chevron-left"></i> Educational Codeforces Round 94 (Rated for Div. 2) 题解
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/09/05/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86%E5%81%9A%E9%A2%98%E5%B0%8F%E8%AE%B0/" rel="next" title="重链剖分做题小记">
      重链剖分做题小记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fsy"
      src="/images/avatar01.png">
  <p class="site-author-name" itemprop="name">fsy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fsy-juruo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fsy-juruo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/evenbao/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;evenbao&#x2F;" rel="noopener" target="_blank">even_bao</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://2006duckonline.github.io/2019/08/13/%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A1%B5/" title="https:&#x2F;&#x2F;2006duckonline.github.io&#x2F;2019&#x2F;08&#x2F;13&#x2F;%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A1%B5&#x2F;" rel="noopener" target="_blank">zyx</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ybw051114.ml/" title="https:&#x2F;&#x2F;ybw051114.ml&#x2F;" rel="noopener" target="_blank">ybw</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://wxq1229.github.io/" title="https:&#x2F;&#x2F;wxq1229.github.io&#x2F;" rel="noopener" target="_blank">wxq</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fsy</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">100k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:30</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '5a61fb0f7adaaeed9336',
      clientSecret: 'aa4e8e185129493ab8ce5d0741589163e72b097c',
      repo        : 'fsy-juruo-comments',
      owner       : 'fsy-juruo',
      admin       : ['fsy-juruo'],
      id          : '7342a753778ae59778e5293446af71cc',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
